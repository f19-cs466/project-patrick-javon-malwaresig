// CS466 Project
// By Javon Kitson, Patrick Sacchet
// Due November 22nd at Midnight

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>

//int OUTPUT = 1; //output will print unless otherwise specified
int RUNNING = 1;
int RUNNING_MAIN = 1;

// Simple function to print all options for the user
// Params - None
// Returns - None
void print_options()
{
  printf("Options:\n");
  printf("  Exit program - 0\n");
  printf("  Print rules - 1\n");
  printf("  Run a scan - 2\n");
  return;
}

// Function will continue to ask user for valid input
// Params - None
// Returns -  input - the input given by the user
int get_input()
{
  int input, result;
  printf("malwaresig > ");
  result = scanf("%d", &input);
  // While the user has not given valid input, we keep running
  while(RUNNING)
  {
    // Check the return value of scanf to ensure we can read it
    if(result == 0 || result == EOF)
    {
      printf("Something went wrong, please try again\n");
      printf("malwaresig > ");
      result = scanf("%d", &input);
    }
    // Check to see the user gave us valid input that is a option, if not, print the options
    else if(input != 0 && input != 1 && input != 2)
    {
      printf("Invalid input, here's some help:\n");
      print_options();
      printf("malwaresig > ");
      result = scanf("%d", &input);
    }
    // Otherwise the user gave us valid input so return their input
    else
    {
      RUNNING = 0;
    }
  }
  RUNNING = 1;
  return input;
}

// Function will print a logo for our program
// Params - None
// Returns - None
void print_logo()
{
  // Print our cool logo (thanks Javon :))
  printf(R"EOF(
      ███╗   ███╗ █████╗ ██╗     ██╗    ██╗ █████╗ ██████╗ ███████╗███████╗██╗ ██████╗
      ████╗ ████║██╔══██╗██║     ██║    ██║██╔══██╗██╔══██╗██╔════╝██╔════╝██║██╔════╝
      ██╔████╔██║███████║██║     ██║ █╗ ██║███████║██████╔╝█████╗  ███████╗██║██║  ███╗
      ██║╚██╔╝██║██╔══██║██║     ██║███╗██║██╔══██║██╔══██╗██╔══╝  ╚════██║██║██║   ██║
      ██║ ╚═╝ ██║██║  ██║███████╗╚███╔███╔╝██║  ██║██║  ██║███████╗███████║██║╚██████╔╝
      ╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝ ╚══╝╚══╝ ╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚══════╝╚═╝ ╚═════╝
  )EOF");
  printf("\n");
  return;
}

// Function will create test directories with test files so we can scan them
// Params - None
// Returns - None 
void create_directories()
{
  char * test_dir = "test_dir";
  int result;
  // 0777 is the access code for all users to be able to access
  result = mkdir(test_dir, 0777);
  if(!result)
  {
    printf("Directory created successfully\n");
  }
  else
  {
    printf("Yikes no directory\n");
  }
}

// Main function
int main(int argc, char *argv[])
{
  int input;

  // Print the logo of course
  print_logo();
  // And print the options initially for the user
  print_options();

  // Get input from the user
  input = get_input();

  while(RUNNING)
  {
    // Check to see if user wants to exit, otherwise perform the desired function
    if(input == 0)
    {
      exit(-1);
    }
    else if(input == 1)
    {
      // Call print rules function
    }
    // User must have input 2
    else
    {
      create_directories();
      input = get_input();
      // Call scan function
    }
  }








    //char input[30];
    //strcpy(input, argv[1]);
/*
    if( strcmp(input,"-h") == 0){
        printf("This is the help for MALWARESIG\n"
            "Options are:\n"
            "    -h: display what you are reading now\n"
            "    -q: output nothing\n");
        return 0;
    }

    if(strcmp(input, "-q") == 0){
            OUTPUT = 0;
            //call function to do things
    }//else if (strcmp(string, "xxx") == 0)
    //{
        // do something else
    //}
     more else if clauses
     */
    //else  default:
    //{
    //    printf("Command not found: Use -h for help\n");
    //}

   // if(OUTPUT){ printf("Analysing: %s\n", argv[1]);}

    return 0;
}
